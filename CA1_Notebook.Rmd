---
title: "R Notebook"
output: html_notebook
---

#### Functions

The following function is the function which will be used to get the mode of the data

```{r}
mymode <- function(x){
  xtable <- table(x)
  idx <- xtable == max(xtable)
  names(xtable)[idx]
}
```

Read in the data from the csv file

```{r}
service_provider_data <- read.csv("./eurocomPHONEchurners.csv")
```

Display the data

```{r}
service_provider_data
```

First thing to do is to print out the data summary.

```{r}
summary(service_provider_data)
```

### Identify null values 

The summary data can be used to identify the columns which contain null values. 

The columns with null values are:

* MINUTES_3MONTHS_AGO (3 records)
* CUST_MOS (3 records)
* TOT_MINUTES_USAGE (4 records)
* PHONE_PLAN (4 records)
* EDUCATION (8 records) 

##### Addressing the issues of the missing values. 

For the numeric values they will be replaced with median value for the columns

**MINUTES_3MONTHS_AGO**
```{r}
median(service_provider_data$MINUTES_3MONTHS_AGO, na.rm = TRUE)
```

```{r}
MINUTES_3MONTHS_AGO_median <- median(service_provider_data$MINUTES_3MONTHS_AGO, na.rm = TRUE)
```

```{r}
service_provider_data$MINUTES_3MONTHS_AGO[is.na(service_provider_data$MINUTES_3MONTHS_AGO)] <- MINUTES_3MONTHS_AGO_median 
```


**CUST_MOS**
```{r}
median(service_provider_data$CUST_MOS, na.rm = TRUE)
```

```{r}
CUST_MOS_median <- median(service_provider_data$CUST_MOS, na.rm = TRUE)
```

```{r}
service_provider_data$CUST_MOS[is.na(service_provider_data$CUST_MOS)] <- CUST_MOS_median 
```


**TOT_MINUTES_USAGE**
```{r}
median(service_provider_data$TOT_MINUTES_USAGE, na.rm = TRUE)
```

```{r}
TOT_MINUTES_USAGE_median <- median(service_provider_data$TOT_MINUTES_USAGE, na.rm = TRUE)
```

```{r}
service_provider_data$TOT_MINUTES_USAGE[is.na(service_provider_data$TOT_MINUTES_USAGE)] <- TOT_MINUTES_USAGE_median 
```


**PHONE_PLAN**

The first thing to do was to ceate a data frame which is comprised of the gender and phone plan

```{r}

  phone_plan_gender_subset <- data.frame(service_provider_data$PHONE_PLAN, service_provider_data$GENDER)

```

```{r}

  phone_plan_gender_subset[1:10,]

```

The data frame is then filtered again so it just contains data for record for male records

```{r}
  phone_plan_male_subset <- temp[temp$service_provider_data.GENDER == 'M', 1]
```

```{r}
  phone_plan_male_subset[1:10]
```


The mode of the phone plan is stored formale records

```{r}

  phone_plan_male_mode <- mymode(phone_plan_male_subset)

```

```{r}

  phone_plan_male_mode

```


The data frame is then filtered again so it just contains data for record for female records

```{r}
  phone_plan_female_subset <- temp[temp$service_provider_data.GENDER == 'F', 1]
```

```{r}
  phone_plan_female_subset[1:10]
```


```{r}

  phone_plan_female_mode <- mymode(phone_plan_female_subset)

```

```{r}

  phone_plan_female_mode

```


We then find the indexes of the phone plan records with empty values

```{r}
  no_phone_plans <- which(service_provider_data$PHONE_PLAN == "")
```

```{r}
  service_provider_data[no_phone_plans,]
```


```{r}
for (index in no_phone_plans)
{
  if (service_provider_data$GENDER[index] == 'M') 
  {
    service_provider_data$PHONE_PLAN[index] <- phone_plan_male_mode
  } 
  else 
  {
    service_provider_data$PHONE_PLAN[index] <- phone_plan_female_mode
  }
}

```

```{r}
  service_provider_data$PHONE_PLAN[no_phone_plans]
```

**EDUCATION**
The first thing to do was to ceate a data frame which is comprised of the gender and education

```{r}

  education_gender_subset <- data.frame(service_provider_data$EDUCATION, service_provider_data$GENDER)

```

```{r}

  education_gender_subset[1:10,]

```

The data frame is then filtered again so it just contains data for record for male records

```{r}
  no_education_male_subset <- education_gender_subset[education_gender_subset$service_provider_data.GENDER == 'M', 1]
```

```{r}
  no_education_male_subset[1:10]
```


The mode of the phone plan is stored formale records

```{r}
  no_education_male_mode <- mymode(no_education_male_subset)
```

```{r}
  no_education_male_mode
```

The data frame is then filtered again so it just contains data for record for female records

```{r}
  no_education_female_subset <- education_gender_subset[education_gender_subset$service_provider_data.GENDER == 'F', 1]
```


```{r}

  no_education_female_mode <- mymode(no_education_female_subset)

```

```{r}

  no_education_female_mode

```


We then find the indexes of the phone plan records with empty values

```{r}
  no_education <- which(service_provider_data$EDUCATION == "")
```

```{r}
  service_provider_data[no_education,]
```



```{r}
for (index in no_education)
{
  if (service_provider_data$GENDER[index] == 'M') 
  {
    service_provider_data$EDUCATION[index] <- no_education_male_mode
  } 
  else 
  {
    service_provider_data$EDUCATION[index] <- no_education_female_mode
  }
}
```

```{r}
service_provider_data$EDUCATION[no_education]
```

```{r}
summary(service_provider_data)
```


```{r}
service_provider_data$INCOME <- cut(service_provider_data$INCOME, breaks=c(0,37999,87999,Inf), labels=c("low income","medium income","high income"))
```

```{r}
service_provider_data[1:10,
                      ]
```



























